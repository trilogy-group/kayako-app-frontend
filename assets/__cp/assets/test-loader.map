{"version":3,"sources":["app/test-loader.js","start.js"],"sourcesContent":["/* globals requirejs, require */\n(function() {\ndefine(\"ember-cli/test-loader\",\n  [],\n  function() {\n    \"use strict\";\n\n    var TestLoader = function() {\n    };\n\n    TestLoader.prototype = {\n      shouldLoadModule: function(moduleName) {\n        return (moduleName.match(/[-_]test$/));\n      },\n\n      loadModules: function() {\n        var moduleName;\n\n        for (moduleName in requirejs.entries) {\n          if (this.shouldLoadModule(moduleName)) {\n            this.require(moduleName);\n          }\n        }\n      }\n    };\n\n    TestLoader.prototype.require = function(moduleName) {\n      try {\n        require(moduleName);\n      } catch(e) {\n        this.moduleLoadFailure(moduleName, e);\n      }\n    };\n\n    TestLoader.prototype.moduleLoadFailure = function(moduleName, error) {\n      console.error('Error loading: ' + moduleName, error.stack);\n    };\n\n    TestLoader.load = function() {\n      new TestLoader().loadModules();\n    };\n\n    return {\n      'default': TestLoader\n    }\n  }\n);\n})();\n","/*global QUnit, blanket, mocha, moduleLoaderFinish, $ */\r\n\r\nfunction sendCoverage() {\r\n\t$.ajax({\r\n\t\ttype: 'POST',\r\n\t\turl:'/write-blanket-coverage',\r\n\t\tdatatype: 'json',\r\n\t\tcontentType:'application/json; charset=utf-8',\r\n\t\tdata: JSON.stringify(window._$blanket_coverageData)\r\n\t  });\r\n}\r\n\r\nvar origBlanketOnTestsDone = blanket.onTestsDone;\r\n\r\nfunction cliFinish() {\r\n  // annotate all files that match but were never referenced\r\n\tmoduleLoaderFinish();\r\n\torigBlanketOnTestsDone.apply(blanket);\r\n\tsendCoverage();\r\n}\r\n\r\nblanket.onTestsDone = cliFinish;\r\n\r\nif (typeof(QUnit) === 'object') {\r\n  QUnit.config.autostart = blanket.options('cliOptions').autostart !== false;\r\n}\r\nelse if (typeof(mocha) === 'object') {\r\n\r\n    /*\r\n    * Mocha-BlanketJS adapter\r\n    * Adds a BlanketJS coverage report at the bottom of the HTML Mocha report\r\n    * Only needed for in-browser report; not required for the grunt/phantomjs task\r\n    *\r\n    * Distributed as part of the grunt-blanket-mocha plugin\r\n    * https://github.com/ModelN/grunt-blanket-mocha\r\n    * (C)2013 Model N, Inc.\r\n    * Distributed under the MIT license\r\n    *\r\n    * Code originally taken from the BlanketJS project:\r\n    * https://github.com/alex-seville/blanket/blob/master/src/adapters/mocha-blanket.js\r\n    * Distributed under the MIT license\r\n    */\r\n    (function() {\r\n\r\n        if(!mocha) {\r\n            throw new Error(\"mocha library does not exist in global namespace!\");\r\n        }\r\n\r\n\r\n        /*\r\n         * Mocha Events:\r\n         *\r\n         *   - `start`  execution started\r\n         *   - `end`  execution complete\r\n         *   - `suite`  (suite) test suite execution started\r\n         *   - `suite end`  (suite) all tests (and sub-suites) have finished\r\n         *   - `test`  (test) test execution started\r\n         *   - `test end`  (test) test completed\r\n         *   - `hook`  (hook) hook execution started\r\n         *   - `hook end`  (hook) hook complete\r\n         *   - `pass`  (test) test passed\r\n         *   - `fail`  (test, err) test failed\r\n         *\r\n         */\r\n\r\n        var originalReporter = mocha._reporter;\r\n\r\n        var blanketReporter = function(runner) {\r\n                runner.on('start', function() {\r\n                  blanket.setupCoverage();\r\n                });\r\n\r\n                runner.on('end', function() {\r\n                  blanket.onTestsDone();\r\n                });\r\n                runner.on('suite', function() {\r\n                    blanket.onModuleStart();\r\n                });\r\n\r\n                runner.on('test', function() {\r\n                    blanket.onTestStart();\r\n                });\r\n\r\n                runner.on('test end', function(test) {\r\n                    blanket.onTestDone(test.parent.tests.length, test.state === 'passed');\r\n                });\r\n\r\n                //I dont know why these became global leaks\r\n                runner.globals(['stats', 'failures', 'runner', '_$blanket']);\r\n\r\n                originalReporter.apply(this, [runner]);\r\n            };\r\n\r\n\r\n        // From mocha.js HTML reporter\r\n        blanketReporter.prototype.suiteURL = function(suite){\r\n          return '?grep=' + encodeURIComponent(suite.fullTitle());\r\n        };\r\n\r\n        blanketReporter.prototype.testURL = function(test){\r\n          return '?grep=' + encodeURIComponent(test.fullTitle());\r\n        };\r\n\r\n        mocha.reporter(blanketReporter);\r\n    })();\r\n}\r\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;","file":"test-loader.js"}